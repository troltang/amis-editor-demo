"use strict";(self.webpackChunkamis_editor_demo=self.webpackChunkamis_editor_demo||[]).push([[1816],{61816:function(e,t,n){n.r(t),n.d(t,{BaseTransferRenderer:function(){return v},TransferRender:function(){return y},default:function(){return m},getCustomFilterOption:function(){return g}});var r=n(31635),l=n(96540),o=n(7309),a=n.n(o),i=n(44383),s=n.n(i),u=n(50346),d=n(51545),p=n(62758),c=n(71121),h=n(66283),g=function(e){switch(typeof e){case"string":return(0,p.sce)(e,"options","inputValue","option");case"function":return e;default:return null}},v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.C6)(t,e),t.prototype.reload=function(){var e=this.props.reloadOptions;null==e||e()},t.prototype.handleChange=function(e,t){return(0,r.sH)(this,void 0,void 0,(function(){var n,l,o,a,i,s,u,d,c,h,g,v,y,m,f,C,S,b;return(0,r.YH)(this,(function(R){switch(R.label){case 0:return n=this.props,l=n.onChange,o=n.joinValues,a=n.delimiter,i=n.valueField,s=n.extractValue,u=n.options,d=n.dispatchEvent,c=n.setOptions,h=n.selectMode,g=n.deferApi,v=n.deferField,y=void 0===v?"defer":v,m=e,f=u.concat(),Array.isArray(e)?(m=e.map((function(e){var n=(0,p.iXH)(u,(0,p.UjQ)(e[i||"value"],i||"value"),{resolve:(0,p.srN)(i),value:e[i]||"value"});if(n){if(t){var l=(0,p.Jvj)(f,n);f=(0,p.Z6D)(f,n,1,(0,r.Cl)((0,r.Cl)({},l),e))}}else f.push((0,r.Cl)((0,r.Cl)({},e),{visible:!1}));return o||s?e[i||"value"]:e})),o&&(m=m.join(a||","))):e&&(m=o||s?e[i||"value"]:e,(C=(0,p.iXH)(u,(0,p.UjQ)(e[i||"value"],i||"value")))?t&&(S=(0,p.Jvj)(f,C),f=(0,p.Z6D)(f,C,1,(0,r.Cl)((0,r.Cl)({},S),e))):f.push((0,r.Cl)((0,r.Cl)({},e),{visible:!1}))),(!0==!("tree"!==h||!g&&!(0,p.cym)(u,(function(e){return e.deferApi||e[y]})))||f.length>u.length||t)&&c(f,!0),[4,d("change",(0,p.RKM)(this.props,{value:m,options:u,items:u}))];case 1:return(null==(b=R.sent())?void 0:b.prevented)||l(m),[2]}}))}))},t.prototype.option2value=function(e){return e},t.prototype.getResult=function(e){return e.data.options||e.data.items||e.data},t.prototype.handleSearch=function(e,t,n){return(0,r.sH)(this,void 0,void 0,(function(){var l,o,i,s,u,c,h,v,y,m,f,C,S,b,R;return(0,r.YH)(this,(function(O){switch(O.label){case 0:if(l=this.props,o=l.searchApi,i=l.options,s=l.labelField,u=l.valueField,c=l.env,h=l.data,v=l.translate,y=l.filterOption,!o)return[3,5];O.label=1;case 1:return O.trys.push([1,3,,4]),[4,c.fetcher(o,(0,p.ed2)(h,(0,r.Cl)({term:e},n||{})),{cancelExecutor:t})];case 2:if(!(m=O.sent()).ok)throw new Error(v(m.msg||"networkError"));if(f=this.getResult(m),!Array.isArray(f))throw new Error(v("CRUD.invalidArray"));return C={},n&&(C={page:m.data.page,perPage:n.perPage,total:m.data.count}),[2,(0,r.Cl)({items:(0,p.X$u)(f,(function(e){var t=null,n=e[u||"value"];return Array.isArray(i)&&null!=n&&(t=a()(i,(0,p.UjQ)(n,u)),(null==e?void 0:e.children)&&(t=(0,r.Cl)((0,r.Cl)({},t),{children:e.children}))),t||e}))},C)];case 3:return S=O.sent(),c.isCancel(S)||o.silent||c.notify("error",S.message),[2,{items:[]}];case 4:return[3,6];case 5:return e?(b={keys:[s||"label",u||"value"]},y?(R=g(y))?[2,{items:R(i,e,b)}]:(c.notify("error","自定义检索函数不符合要求"),[2,{items:[]}]):[2,{items:(0,p.hVz)(i,(function(t,n,r,l){return!!(Array.isArray(t.children)&&t.children.length||(0,d.Ht)([t].concat(l),e,{keys:[s||"label",u||"value"],threshold:d.Ht.rankings.CONTAINS}).length)}),0,!0)}]):[2,{items:i}];case 6:return[2]}}))}))},t.prototype.handleResultSearch=function(e,t){var n=this.props,r=n.valueField,l=n.labelField,o=(0,p.NhP)(e),a=t[l||"label"],i=t[r||"value"];return o.test(a)||o.test(i)},t.prototype.handlePageChange=function(e,t,n){var l=this.props,o=l.source,a=l.data,i=l.formItem,s=l.onChange,d=(0,p.ed2)(a,(0,r.Cl)({page:null!=e?e:1,perPage:null!=t?t:10},n?{pageDir:n}:{}));i&&(0,u._n)(i)&&((0,p.joH)(o)?i.loadOptionsFromDataScope(o,d,s):(0,p.Amo)(o,d)&&i.loadOptions(o,d,void 0,!1,s,!1))},t.prototype.optionItemRender=function(e,t){var n=this.props,r=n.menuTpl,l=n.render,o=n.data;return l("item/".concat(t.index),r,{data:(0,p.ed2)((0,p.ed2)(o,t),e)})},t.prototype.resultItemRender=function(e,t){var n=this.props,r=n.valueTpl,l=n.render,o=n.data;return l("value/".concat(t.index),r,{onChange:t.onChange,data:(0,p.ed2)((0,p.ed2)(o,t),e)})},t.prototype.renderCell=function(e,t,n,l){var o=this.props,a=o.render,i=o.data,s=o.classnames,u=o.showInvalidMatch;return a("cell/".concat(n,"/").concat(l),(0,r.Cl)({type:"text",className:s({"is-invalid":!!u&&(null==t?void 0:t.__unmatched)})},e),{value:(0,p.FL9)(e.name,t),data:(0,p.ed2)(i,t)})},t.prototype.getRef=function(e){for(;e&&e.getWrappedInstance;)e=e.getWrappedInstance();this.tranferRef=e},t.prototype.onSelectAll=function(e){var t=this.props,n=t.dispatchEvent,r=t.data;n("selectAll",(0,p.ed2)(r,{items:e}))},t.prototype.doAction=function(e,t,n){var r,l,o,a,i,s=this.props,u=s.resetValue,d=s.onChange,c=s.formStore,h=s.store,g=s.name;switch(e.actionType){case"clear":null==d||d("");break;case"reset":null==d||d(null!==(o=null!==(l=(0,p.dnO)(null!==(r=null==c?void 0:c.pristine)&&void 0!==r?r:null==h?void 0:h.pristine,g))&&void 0!==l?l:u)&&void 0!==o?o:"");break;case"selectAll":null===(a=this.tranferRef)||void 0===a||a.selectAll();break;case"clearSearch":null===(i=this.tranferRef)||void 0===i||i.clearSearch(t)}},t.prototype.render=function(){var e,t,n=this.props,o=n.className,a=(n.style,n.classnames),i=n.selectedOptions,u=n.showArrow,d=n.sortable,h=n.selectMode,g=n.columns,v=n.loading,y=n.searchable,m=n.searchResultMode,f=n.searchResultColumns,C=n.deferLoad,S=n.leftMode,b=n.rightMode,R=n.disabled,O=n.selectTitle,A=n.resultTitle,F=n.menuTpl,w=n.valueTpl,I=n.searchPlaceholder,P=n.resultListModeFollowSelect,j=void 0!==P&&P,T=n.resultSearchPlaceholder,M=n.resultSearchable,N=void 0!==M&&M,k=n.statistics,H=n.labelField,x=n.valueField,E=n.virtualThreshold,D=n.itemHeight,B=n.loadingConfig,V=n.showInvalidMatch,_=n.onlyChildren,U=n.mobileUI,L=n.noResultsText,Q=n.pagination,z=n.formItem,X=n.env,J=n.popOverContainer,W=n.data,Y=n.autoCheckChildren,Z=void 0===Y||Y,$=n.initiallyOpen,q=void 0===$||$,K=n.testIdBuilder,G=this.props,ee=G.options,te=G.leftOptions,ne=G.leftDefaultValue;return"associated"===h&&ee&&ee.length&&ee[0].leftOptions&&Array.isArray(ee[0].children)&&(te=ee[0].leftOptions,ne=null!==(e=ee[0].leftDefaultValue)&&void 0!==e?e:ne,ee=ee[0].children),l.createElement("div",{className:a("TransferControl",o)},l.createElement(c.mr,{onlyChildren:_,value:i,options:ee,accumulatedOptions:null!==(t=null==z?void 0:z.accumulatedOptions)&&void 0!==t?t:[],disabled:R,onChange:this.handleChange,option2value:this.option2value,sortable:d,showArrow:u,selectMode:h,searchResultMode:m,searchResultColumns:f,columns:g,onSearch:y?this.handleSearch:void 0,onDeferLoad:C,leftOptions:te,leftMode:S,rightMode:b,cellRender:this.renderCell,selectTitle:O,resultTitle:A,resultListModeFollowSelect:j,onResultSearch:this.handleResultSearch,searchPlaceholder:I,resultSearchable:N,resultSearchPlaceholder:T,statistics:k,labelField:H,valueField:x,optionItemRender:F?this.optionItemRender:void 0,resultItemRender:w?this.resultItemRender:void 0,onSelectAll:this.onSelectAll,onRef:this.getRef,virtualThreshold:E,itemHeight:(0,p.Roz)(D)>0?(0,p.Roz)(D):void 0,loadingConfig:B,showInvalidMatch:V,mobileUI:U,noResultsText:L,pagination:(0,r.Cl)((0,r.Cl)({},s()(Q,["className","layout","perPageAvailable","popOverContainerSelector"])),{enable:(Q&&void 0!==Q.enable?!!("string"==typeof Q.enable?(0,p.pgu)(Q.enable,W):Q.enable):!!(null==z?void 0:z.enableSourcePagination))&&(!h||"list"===h||"table"===h)&&ee.length>0,maxButtons:Number.isInteger(null==Q?void 0:Q.maxButtons)?Q.maxButtons:5,page:null==z?void 0:z.sourcePageNum,perPage:null==z?void 0:z.sourcePerPageNum,total:null==z?void 0:z.sourceTotalNum,popOverContainer:null!=J?J:null==X?void 0:X.getModalContainer}),onPageChange:this.handlePageChange,initiallyOpen:q,autoCheckChildren:Z,testIdBuilder:K}),l.createElement(c.y$,{overlay:!0,key:"info",loadingConfig:B,show:v}))},t.defaultProps={multiple:!0},(0,r.Cg)([p.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Boolean]),(0,r.Sn)("design:returntype",Promise)],t.prototype,"handleChange",null),(0,r.Cg)([p.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"option2value",null),(0,r.Cg)([p.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"getResult",null),(0,r.Cg)([p.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[String,Function,Object]),(0,r.Sn)("design:returntype",Promise)],t.prototype,"handleSearch",null),(0,r.Cg)([p.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[String,Object]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"handleResultSearch",null),(0,r.Cg)([p.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Number,Number,String]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"handlePageChange",null),(0,r.Cg)([p.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Object]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"optionItemRender",null),(0,r.Cg)([p.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Object]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"resultItemRender",null),(0,r.Cg)([p.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object,Object,Number,Number]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"renderCell",null),(0,r.Cg)([p.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Object]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"getRef",null),(0,r.Cg)([p.d6t,(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[Array]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"onSelectAll",null),(0,r.Cg)([(0,h.E)(),(0,r.Sn)("design:type",Function),(0,r.Sn)("design:paramtypes",[]),(0,r.Sn)("design:returntype",void 0)],t.prototype,"render",null),t}(l.Component),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.C6)(t,e),t}(v),m=(0,p.QqA)({type:"transfer"})(y)}}]);